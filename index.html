<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>My Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#f5f5f5;
}
.hidden{display:none}
header{
  background:#111;
  color:white;
  padding:15px;
  text-align:center;
}
.container{
  padding:15px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:15px;
}
.card{
  background:white;
  border-radius:10px;
  padding:15px;
  box-shadow:0 2px 8px rgba(0,0,0,.1);
}
button{
  padding:10px;
  border:none;
  border-radius:6px;
  background:#111;
  color:white;
  cursor:pointer;
}
input{
  width:100%;
  padding:10px;
  margin:8px 0;
}
nav{
  display:flex;
  justify-content:space-around;
  background:#222;
  color:white;
  padding:10px;
}
nav span{
  cursor:pointer;
}
</style>
</head>

<body>

<header>ðŸ›’ My Store</header>

<!-- LOGIN -->
<div id="login" class="container">
  <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
  <input id="email" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„">
  <input id="password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  <p onclick="showRegister()" style="cursor:pointer">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</p>
</div>

<!-- REGISTER -->
<div id="register" class="container hidden">
  <h3>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</h3>
  <input id="rname" placeholder="Ø§Ù„Ø§Ø³Ù…">
  <input id="remail" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„">
  <input id="rpassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button onclick="register()">Ø¥Ù†Ø´Ø§Ø¡</button>
</div>

<!-- HOME -->
<div id="home" class="hidden">
  <nav>
    <span onclick="showProducts()">Ø§Ù„Ù…ØªØ¬Ø±</span>
    <span onclick="showOrders()">Ø·Ù„Ø¨Ø§ØªÙŠ</span>
    <span onclick="logout()">Ø®Ø±ÙˆØ¬</span>
  </nav>

  <div id="products" class="container">
    <h3>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
    <div id="productList" class="grid"></div>
  </div>

  <div id="orders" class="container hidden">
    <h3>Ø·Ù„Ø¨Ø§ØªÙŠ</h3>
    <div id="orderList"></div>
  </div>
</div>

<script>
// ðŸ”¥ Firebase config (ØºÙŠÙ‘Ø±Ù‡)
firebase.initializeApp({
  apiKey: "API_KEY",
  authDomain: "PROJECT.firebaseapp.com",
  projectId: "PROJECT"
});

const auth=firebase.auth();
const db=firebase.firestore();

function show(id){
  document.querySelectorAll("body>div").forEach(d=>d.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function showRegister(){show("register")}
function showHome(){show("home")}
function showProducts(){
  document.getElementById("products").classList.remove("hidden");
  document.getElementById("orders").classList.add("hidden");
}
function showOrders(){
  document.getElementById("orders").classList.remove("hidden");
  document.getElementById("products").classList.add("hidden");
}

function register(){
  auth.createUserWithEmailAndPassword(remail.value,rpassword.value)
  .then(u=>{
    return db.collection("users").doc(u.user.uid).set({
      name:rname.value
    });
  })
  .then(showHome)
  .catch(e=>alert(e.message));
}

function login(){
  auth.signInWithEmailAndPassword(email.value,password.value)
  .then(showHome)
  .catch(e=>alert(e.message));
}

function logout(){
  auth.signOut();
  show("login");
}

// Ù…Ù†ØªØ¬Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
const products=[
  {id:1,name:"Ù…Ù†ØªØ¬ 1",price:10},
  {id:2,name:"Ù…Ù†ØªØ¬ 2",price:20},
];

function loadProducts(){
  productList.innerHTML="";
  products.forEach(p=>{
    productList.innerHTML+=`
      <div class="card">
        <h4>${p.name}</h4>
        <p>${p.price}$</p>
        <button onclick="order('${p.name}')">Ø´Ø±Ø§Ø¡</button>
      </div>`;
  });
}

function order(name){
  const user=auth.currentUser;
  if(!user)return;
  db.collection("orders").add({
    user:user.uid,
    product:name,
    status:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",
    date:new Date()
  });
  alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨");
}

function loadOrders(){
  const user=auth.currentUser;
  if(!user)return;
  orderList.innerHTML="";
  db.collection("orders")
  .where("user","==",user.uid)
  .onSnapshot(s=>{
    orderList.innerHTML="";
    s.forEach(d=>{
      orderList.innerHTML+=`
        <div class="card">
          ${d.data().product} - ${d.data().status}
        </div>`;
    });
  });
}

auth.onAuthStateChanged(u=>{
  if(u){
    showHome();
    loadProducts();
    loadOrders();
  }
});
</script>

</body>
</html>
