<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Best Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  margin:0;font-family:tahoma;
  background:#0f172a;color:#fff
}
header{
  background:#020617;padding:15px;
  display:flex;justify-content:space-between;align-items:center
}
button{
  background:#2563eb;color:#fff;
  border:none;border-radius:8px;
  padding:8px 14px;cursor:pointer
}
input,select,textarea{
  width:100%;padding:8px;margin:5px 0;
  border-radius:6px;border:none
}
.card{
  background:#020617;border-radius:14px;
  padding:15px;margin:15px
}
.products{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:15px;padding:10px
}
.product img{
  width:100%;border-radius:10px
}
.hidden{display:none}
.badge{background:#16a34a;padding:4px 8px;border-radius:6px}
.delete{background:#dc2626;margin-top:5px}
</style>
</head>

<body>

<header>
  <div>
    <b>BEST STORE</b><br>
    <small>رصيدك: <span id="balance">0</span></small>
  </div>
  <div id="userBox">
    <button onclick="openLogin()">تسجيل الدخول</button>
  </div>
</header>

<!-- تسجيل الدخول -->
<div id="loginBox" class="card hidden">
  <h3>تسجيل الدخول</h3>
  <input id="email" placeholder="اكتب الإيميل">
  <button onclick="login()">دخول</button>
</div>

<!-- لوحة الأدمن -->
<div id="adminPanel" class="card hidden">
  <h3>إضافة منتج</h3>
  <input id="pName" placeholder="اسم المنتج">
  <input id="pPrice" placeholder="السعر">
  <select id="pCat">
    <option>تطبيقات</option>
    <option>أشياء</option>
  </select>
  <textarea id="pDesc" placeholder="وصف المنتج"></textarea>
  <input id="pQty" placeholder="الرصيد / الكمية">
  <input type="file" id="pImg">
  <button onclick="addProduct()">إضافة المنتج</button>
</div>

<!-- المنتجات -->
<div class="products" id="products"></div>

<!-- تعبئة الرصيد -->
<div class="card">
  <h3>تعبئة الرصيد عبر شام كاش</h3>
  <p>التحويل إلى الحساب:</p>
  <b>29607b06505ee18f34a7fc5022404325</b>
  <input id="chargeAmount" placeholder="المبلغ">
  <input type="file" id="chargeImg">
  <button onclick="charge()">إرسال طلب التعبئة</button>
</div>

<script>
const ADMIN="wled49645@gmail.com";
let user=localStorage.getItem("user");
let balance=parseInt(localStorage.getItem("balance")||0);
let products=JSON.parse(localStorage.getItem("products")||"[]");

balanceSpan.innerText=balance;

if(user){
  userBox.innerHTML=user;
  if(user===ADMIN) adminPanel.classList.remove("hidden");
}

function openLogin(){
  loginBox.classList.toggle("hidden");
}

function login(){
  let e=email.value;
  if(!e)return;
  user=e;
  localStorage.setItem("user",e);
  userBox.innerHTML=e;
  loginBox.classList.add("hidden");
  if(e===ADMIN) adminPanel.classList.remove("hidden");
}

function addProduct(){
  let file=pImg.files[0];
  let reader=new FileReader();
  reader.onload=()=>{
    products.push({
      name:pName.value,
      price:pPrice.value,
      cat:pCat.value,
      desc:pDesc.value,
      qty:pQty.value,
      img:reader.result
    });
    localStorage.setItem("products",JSON.stringify(products));
    render();
  };
  reader.readAsDataURL(file);
}

function deleteProduct(i){
  products.splice(i,1);
  localStorage.setItem("products",JSON.stringify(products));
  render();
}

function render(){
  productsBox.innerHTML="";
  products.forEach((p,i)=>{
    productsBox.innerHTML+=`
    <div class="card product">
      <img src="${p.img}">
      <h4>${p.name}</h4>
      <span class="badge">${p.cat}</span>
      <p>${p.desc}</p>
      <p>الرصيد: ${p.qty}</p>
      <b>${p.price}</b>
      <input placeholder="ID الخاص بك">
      <textarea placeholder="وصف إضافي"></textarea>
      ${user===ADMIN?`<button class="delete" onclick="deleteProduct(${i})">حذف</button>`:""}
    </div>`;
  });
}

function charge(){
  let file=chargeImg.files[0];
  if(!file)return alert("أضف صورة التحويل");
  let amount=parseInt(chargeAmount.value);
  if(!amount)return;
  balance+=amount;
  localStorage.setItem("balance",balance);
  balanceSpan.innerText=balance;
  alert("تم إرسال الطلب وسيتم المراجعة");
}

render();
</script>

</body>
</html>
